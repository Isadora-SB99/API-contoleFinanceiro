name: Entrega cont√≠nua

on:
  workflow_call:
  
env:
  AWS_REGION: us-east-2
  REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
  REMOTE_USER: ${{ secrets.REMOTE_USER }}

permissions:
  contents: read
  id-token: write

jobs:

  ec2:
      
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install SSH key
        uses: shimataro/ssh-key-action@v2
        with:
          key: ${{ secrets.SSH_PRIVATE_KEY }} 
          name: id_rsa
          known_hosts: ${{ env.REMOTE_HOST }}
      - name: rsync over ssh
        run: ./deploy_to_aws.sh
